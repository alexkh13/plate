<!DOCTYPE html>
<html>
<head>
    <title>Test AI Analyze Flow</title>
</head>
<body>
    <h1>AI Analyze Flow Test</h1>
    <input type="file" id="fileInput" accept="image/*" multiple>
    <button onclick="testFlow()">Test Flow</button>
    <pre id="output"></pre>
    
    <script>
        function log(msg) {
            document.getElementById('output').textContent += msg + '\n';
            console.log(msg);
        }
        
        function testFlow() {
            const files = document.getElementById('fileInput').files;
            log('ğŸ“ Files selected: ' + files.length);
            
            if (files.length === 0) {
                log('âŒ No files selected');
                return;
            }
            
            // Convert files to data URLs
            const filePromises = Array.from(files).map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onloadend = () => resolve(reader.result);
                    reader.readAsDataURL(file);
                });
            });
            
            Promise.all(filePromises).then(dataUrls => {
                log('ğŸ’¾ Storing ' + dataUrls.length + ' images in sessionStorage');
                sessionStorage.setItem('aiAnalyzeImages', JSON.stringify(dataUrls));
                log('âœ… Stored successfully');
                log('ğŸ“¦ SessionStorage size: ' + sessionStorage.getItem('aiAnalyzeImages').length + ' bytes');
                
                // Test retrieval
                const retrieved = sessionStorage.getItem('aiAnalyzeImages');
                if (retrieved) {
                    const parsed = JSON.parse(retrieved);
                    log('âœ… Retrieved ' + parsed.length + ' images from sessionStorage');
                } else {
                    log('âŒ Failed to retrieve from sessionStorage');
                }
            });
        }
    </script>
</body>
</html>
